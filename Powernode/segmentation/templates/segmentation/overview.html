{% extends "segmentation/base.html" %}
{% block title %}分群概览{% endblock %}
{% block content %}
<div class="row g-3 mb-3">
    <div class="col-lg-4">
        <div class="card h-100">
            <div class="card-body">
                <h5 class="card-title">分群参数</h5>
                <p class="mb-1">使用K：{{ metrics.k_used|default:"-" }}</p>
                <p class="mb-1">选择方式：{{ metrics.method|default:"-" }}</p>
                <p class="mb-1">自动选K：{{ metrics.k_auto }}</p>
                <p class="mb-1">K范围：{{ metrics.k_range|default:"" }}</p>
                <p class="mb-0">惯性 (inertia)：{{ metrics.inertia|floatformat:2 }}</p>
            </div>
        </div>
    </div>
    <div class="col-lg-8">
        <div class="row g-3">
            {% for item in summaries %}
            <div class="col-md-6">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title">Cluster {{ item.cluster_id }}</h5>
                        <p class="mb-1">样本数：{{ item.size }}</p>
                        <p class="mb-1">均消费额：{{ item.avg_amount|floatformat:2 }}</p>
                        <p class="mb-1">均订单数：{{ item.avg_order_count|floatformat:2 }}</p>
                        <p class="mb-1">偏好品类：{{ item.top_category }}</p>
                        <p class="mb-1">偏好渠道：{{ item.top_channel }}</p>
                        <p class="mb-1">偏好设备：{{ item.top_device }}</p>
                        <p class="mb-0">推荐动作：{{ item.action }}</p>
                    </div>
                </div>
            </div>
            {% empty %}
            <p class="px-3">暂无分群结果，请先上传数据。</p>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}

